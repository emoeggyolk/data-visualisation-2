{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "width": 700,
  "height": 400,
  "background": "#f8fafc",
  "title": {
    "text": "Births vs Marriages in Malaysia (2017â€“2022)",
    "fontSize": 18,
    "color": "#000000"
  },

  "resolve": { "scale": { "y": "independent" } },

  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/emoeggyolk/data-visualisation-2/refs/heads/main/data/births.csv"
      },
      "transform": [
        { "calculate": "year(toDate(datum.date))", "as": "year" },
        { "filter": "datum.year >= 2017 && datum.year <= 2022" },
        { "aggregate": [{ "op": "sum", "field": "births", "as": "total_births" }], "groupby": ["year"] },
        { "calculate": "'Births'", "as": "series" }
      ],
      "mark": { "type": "line", "point": {"filled": true, "size": 70}, "strokeWidth": 2.5 },
      "encoding": {
        "x": {
          "field": "year",
          "type": "ordinal",
          "title": "Year",
          "axis": { "labelAngle": 0, "tickCount": 6 }
        },
        "y": {
          "field": "total_births",
          "type": "quantitative",
          "title": "Total Births",
          "axis": { "format": ",", "titleColor": "#0072B2" },
          "scale": {"domain": [300000, 550000]}
        },
        "color": {
          "field": "series",
          "type": "nominal",
          "title": "Series",
          "scale": { "domain": ["Births", "Marriages"], "range": ["#0072B2", "#D55E00"] },
          "legend": { "orient": "right" }
        },
        "tooltip": [
          { "field": "year", "title": "Year" },
          { "field": "total_births", "title": "Total Births", "format": "," }
        ]
      }
    },

    {
      "data": {
        "url": "https://raw.githubusercontent.com/emoeggyolk/data-visualisation-2/refs/heads/main/data/marriages.csv"
      },
      "transform": [
        { "calculate": "year(toDate(datum.date))", "as": "year" },
        { "filter": "datum.year >= 2017 && datum.year <= 2022" },
        { "aggregate": [{ "op": "sum", "field": "abs", "as": "total_marriages" }], "groupby": ["year"] },
        { "calculate": "'Marriages'", "as": "series" }
      ],
      "mark": { "type": "line", "point": {"filled": true, "size": 70}, "strokeWidth": 2.5 },
      "encoding": {
        "x": { "field": "year", "type": "ordinal" },
        "y": {
          "field": "total_marriages",
          "type": "quantitative",
          "title": "Total Marriages",
          "axis": { "format": ",", "titleColor": "#D55E00", "orient": "right" },
          "scale": {"domain": [300000, 550000]}
        },
        "color": {
          "field": "series",
          "type": "nominal",
          "scale": { "domain": ["Births", "Marriages"], "range": ["#0072B2", "#D55E00"] }
        },
        "tooltip": [
          { "field": "year", "title": "Year" },
          { "field": "total_marriages", "title": "Total Marriages", "format": "," }
        ]
      }
    }
  ],

  "config": {
    "view": { "stroke": null },
    "axis": { "labelFontSize": 12, "titleFontSize": 12 },
    "legend": { "titleFontSize": 12, "labelFontSize": 11 }
  }
}
